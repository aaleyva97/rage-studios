<div class="success-container min-h-screen bg-gradient-to-br from-green-50 to-blue-50 py-12 px-4">
  <div class="max-w-md mx-auto">

    <!-- üîÑ ESTADO: Procesando -->
    @if (paymentState() === 'processing') {
      <p-card class="text-center">
        <div class="py-12">
          <p-progressSpinner />
          <p class="mt-4 text-gray-600 font-medium">{{ statusMessage() }}</p>
          @if (retryAttempt() > 0) {
            <p class="mt-2 text-sm text-gray-500">
              Intento {{ retryAttempt() }} de {{ 3 }}
            </p>
          }
        </div>
      </p-card>
    }

    <!-- ‚úÖ ESTADO: √âxito -->
    @else if (paymentState() === 'success') {
      <p-card class="text-center shadow-xl">
        <div class="py-8">
          <div class="mb-6">
            <i class="pi pi-check-circle text-6xl text-green-500"></i>
          </div>
          <h1 class="text-2xl font-bold text-gray-800 mb-4">
            ¬°Pago Exitoso!
          </h1>
          <p class="text-gray-600 mb-8">
            Tu paquete ha sido activado correctamente.
            Los cr√©ditos ya est√°n disponibles en tu cuenta.
          </p>

          <div class="flex flex-col gap-3">
            <p-button
              label="Ver Mis Cr√©ditos"
              severity="primary"
              icon="pi pi-wallet"
              (onClick)="goToAccount()"
              styleClass="w-full" />

            <p-button
              label="Volver al Inicio"
              severity="secondary"
              [outlined]="true"
              icon="pi pi-home"
              (onClick)="goToHome()"
              styleClass="w-full" />
          </div>
        </div>
      </p-card>
    }

    <!-- ‚ÑπÔ∏è ESTADO: Ya procesado anteriormente -->
    @else if (paymentState() === 'already_processed') {
      <p-card class="text-center shadow-xl">
        <div class="py-8">
          <div class="mb-6">
            <i class="pi pi-info-circle text-6xl text-blue-500"></i>
          </div>
          <h1 class="text-2xl font-bold text-gray-800 mb-4">
            Pago Ya Procesado
          </h1>
          <p class="text-gray-600 mb-8">
            {{ statusMessage() }}
            <br>
            <span class="text-sm text-gray-500">Tus cr√©ditos ya est√°n en tu cuenta.</span>
          </p>

          <div class="flex flex-col gap-3">
            <p-button
              label="Ver Mis Cr√©ditos"
              severity="primary"
              icon="pi pi-wallet"
              (onClick)="goToAccount()"
              styleClass="w-full" />

            <p-button
              label="Volver al Inicio"
              severity="secondary"
              [outlined]="true"
              icon="pi pi-home"
              (onClick)="goToHome()"
              styleClass="w-full" />
          </div>
        </div>
      </p-card>
    }

    <!-- ‚è±Ô∏è ESTADO: Timeout -->
    @else if (paymentState() === 'timeout') {
      <p-card class="text-center shadow-xl">
        <div class="py-8">
          <div class="mb-6">
            <i class="pi pi-clock text-6xl text-orange-500"></i>
          </div>
          <h1 class="text-2xl font-bold text-gray-800 mb-4">
            Procesamiento Lento
          </h1>
          <p class="text-gray-600 mb-4">
            {{ errorMessage() }}
          </p>
          <p class="text-sm text-gray-500 mb-8">
            {{ statusMessage() }}
            <br>
            Si no ves tus cr√©ditos, contacta a soporte.
          </p>

          <div class="flex flex-col gap-3">
            <p-button
              label="Reintentar"
              severity="contrast"
              icon="pi pi-refresh"
              (onClick)="retryPayment()"
              class="w-full" />

            <p-button
              label="Ver Mi Cuenta"
              severity="primary"
              [outlined]="true"
              icon="pi pi-wallet"
              (onClick)="goToAccount()"
              styleClass="w-full" />

            <p-button
              label="Volver al Inicio"
              severity="secondary"
              [outlined]="true"
              icon="pi pi-home"
              (onClick)="goToHome()"
              styleClass="w-full" />
          </div>
        </div>
      </p-card>
    }

    <!-- ‚ùå ESTADO: Error -->
    @else if (paymentState() === 'error') {
      <p-card class="text-center shadow-xl">
        <div class="py-8">
          <div class="mb-6">
            <i class="pi pi-times-circle text-6xl text-red-500"></i>
          </div>
          <h1 class="text-2xl font-bold text-gray-800 mb-4">
            Error en el Proceso
          </h1>
          <p class="text-red-600 mb-4">
            {{ errorMessage() }}
          </p>
          <p class="text-sm text-gray-500 mb-8">
            Si realizaste el pago, tus cr√©ditos se procesar√°n autom√°ticamente.
            <br>
            Puedes verificar en "Mi Cuenta" o reintentar.
          </p>

          <div class="flex flex-col gap-3">
            <p-button
              label="Reintentar"
              severity="danger"
              icon="pi pi-refresh"
              (onClick)="retryPayment()"
              styleClass="w-full" />

            <p-button
              label="Ver Mi Cuenta"
              severity="primary"
              [outlined]="true"
              icon="pi pi-wallet"
              (onClick)="goToAccount()"
              styleClass="w-full" />

            <p-button
              label="Volver al Inicio"
              severity="secondary"
              [outlined]="true"
              icon="pi pi-home"
              (onClick)="goToHome()"
              styleClass="w-full" />
          </div>
        </div>
      </p-card>
    }

  </div>
</div>