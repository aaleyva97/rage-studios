<nav class="topbar">
  <div class="topbar-container">
    <div class="logo">
      <span class="logo-text">RAGE</span>
    </div>
    
    <!-- Hamburger menu button for mobile -->
    <p-button 
      icon="pi pi-bars" 
      severity="secondary" 
      [text]="true"
      size="large"
      class="md:hidden"
      (onClick)="toggleMobileMenu()"
      [attr.aria-expanded]="mobileMenuVisible()"
      [attr.aria-controls]="mobileMenuVisible() ? 'mobile-menu-drawer' : null">
    </p-button>
    
    <!-- Desktop menu -->
    <div class="nav-menu">
      @for (item of menuItems(); track item.routerLink) {
        <a [routerLink]="item.routerLink" class="nav-item">
          <span>{{ item.label }}</span>
          <div class="nav-underline"></div>
        </a>
      }
      
      @if (!isLoggedIn()) {
        <p-button 
          label="Iniciar Sesión" 
          severity="primary" 
          size="small"
          (onClick)="openLoginDialog()"
          styleClass="ml-4">
        </p-button>
      } @else {
        <p-button 
          label="Reservar" 
          severity="success" 
          size="small"
          routerLink="/reservar"
          styleClass="ml-4">
        </p-button>
      }
    </div>
  </div>
</nav>

<!-- Mobile menu drawer -->
<p-drawer 
  [(visible)]="mobileMenuVisible" 
  position="right" 
  id="mobile-menu-drawer"
  styleClass="!w-full sm:!w-80"
  (onHide)="closeMobileMenu()">
  
  <!-- Mobile menu content -->
  <div class="flex flex-col gap-4 pt-8 px-4 relative">
    <!-- Close button positioned absolutely -->
    <p-button 
      icon="pi pi-times" 
      severity="secondary" 
      [text]="true"
      size="large"
      class="absolute top-2 right-2"
      (onClick)="closeMobileMenu()"
      aria-label="Close menu">
    </p-button>
    @for (item of menuItems(); track item.routerLink) {
      <a 
        [routerLink]="item.routerLink" 
        class="mobile-nav-item"
        (click)="onMenuItemClick()">
        <span>{{ item.label }}</span>
      </a>
    }
    
    <div class="pt-4 mt-4">
      @if (!isLoggedIn()) {
        <p-button 
          label="Iniciar Sesión" 
          severity="primary" 
          size="small"
          class="w-full"
          (onClick)="onLoginFromMobile()">
        </p-button>
      } @else {
        <p-button 
          label="Reservar" 
          severity="success" 
          size="small"
          class="w-full"
          routerLink="/reservar"
          (onClick)="onMenuItemClick()">
        </p-button>
      }
    </div>
  </div>
</p-drawer>

<app-login-dialog 
  [(visible)]="showLoginDialog"
  (openRegister)="onOpenRegisterFromLogin()">
</app-login-dialog>

<app-register-dialog 
  [(visible)]="showRegisterDialog"
  (openLogin)="onOpenLoginFromRegister()">
</app-register-dialog>
