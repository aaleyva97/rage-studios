<p-toast />
<nav class="topbar">
  <div class="topbar-container">
    <div class="logo">
      <span class="logo-text">RAGE STUDIOS</span>
    </div>
    
    <p-button 
      icon="pi pi-bars" 
      severity="secondary" 
      [text]="true"
      size="large"
      class="md:hidden"
      (onClick)="toggleMobileMenu()"
      [attr.aria-expanded]="mobileMenuVisible()"
      [attr.aria-controls]="mobileMenuVisible() ? 'mobile-menu-drawer' : null">
    </p-button>
    
    <div class="nav-menu">
      @for (item of menuItems(); track item.routerLink) {
        <a [routerLink]="item.routerLink" class="nav-item">
          <span>{{ item.label }}</span>
          <div class="nav-underline"></div>
        </a>
      }
      
      @if (!isLoggedIn()) {
        <p-button 
          label="Iniciar Sesi贸n" 
          severity="primary" 
          size="small"
          (onClick)="openLoginDialog()"
          styleClass="ml-4">
        </p-button>
      } @else {
        <div class="flex items-center gap-2 ml-4">
          <p-button 
            label="Reservar" 
            severity="success" 
            size="small"
            routerLink="/reservar">
          </p-button>
          <p-button 
            icon="pi pi-sign-out" 
            severity="secondary" 
            size="small"
            [text]="true"
            [rounded]="true"
            pTooltip="Cerrar Sesi贸n"
            tooltipPosition="bottom"
            (onClick)="logout()">
          </p-button>
        </div>
      }
    </div>
  </div>
</nav>

<p-drawer 
  [(visible)]="mobileMenuVisible" 
  position="right"
  id="mobile-menu-drawer"
  styleClass="!w-full sm:!w-80"
  (onHide)="closeMobileMenu()">
  
  <ng-template #header>
    <div class="flex justify-end w-full"></div>
  </ng-template>
  
  <div class="flex flex-col gap-6 pt-4 px-6 items-center">
    @for (item of menuItems(); track item.routerLink) {
      <a 
        [routerLink]="item.routerLink" 
        class="mobile-nav-item"
        (click)="onMenuItemClick()">
        <span>{{ item.label }}</span>
      </a>
    }
    
    <div class="pt-4 mt-4 border-t border-gray-200 w-full">
      @if (!isLoggedIn()) {
        <p-button 
          label="Iniciar Sesi贸n" 
          severity="primary" 
          size="small"
          class="w-full"
          (onClick)="onLoginFromMobile()">
        </p-button>
      } @else {
        <div class="flex flex-col gap-3">
          <p-button 
            label="Reservar" 
            severity="success" 
            size="small"
            class="w-full"
            routerLink="/reservar"
            (onClick)="onMenuItemClick()">
          </p-button>
          <p-button 
            label="Cerrar Sesi贸n" 
            severity="secondary" 
            size="small"
            class="w-full"
            [outlined]="true"
            icon="pi pi-sign-out"
            (onClick)="onLogoutFromMobile()">
          </p-button>
        </div>
      }
    </div>
  </div>
</p-drawer>

<app-login-dialog 
  [(visible)]="showLoginDialog" 
  (openRegister)="onOpenRegisterFromLogin()">
</app-login-dialog>

<app-register-dialog 
  [(visible)]="showRegisterDialog" 
  (openLogin)="onOpenLoginFromRegister()">
</app-register-dialog>